(()=>{"use strict";const e=window.wp.element,t=window.React,a=window.wp.i18n,s=t=>{let{item:a,additionalClasses:s,count:n,onTitleClick:r}=t;const{title:l,value:c}=a,i=0===n&&"attending"!==c?"hidden":"active";return(0,e.createElement)("div",{className:`wp-block-gatherpress-attendance-list__navigation-item wp-block-gatherpress-attendance-list__${i} ${s}`},(0,e.createElement)("a",{className:"wp-block-gatherpress-attendance-list__anchor","data-item":c,"data-toggle":"tab",href:"#",role:"tab","aria-controls":`#gp-attendance-${c}`,onClick:e=>r(e,c)},l),(0,e.createElement)("span",{className:"wp-block-gatherpress-attendance-list__count"},"(",n,")"))},n=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const[a,s]of Object.entries(e)){let e=a;t&&(e+=t),addEventListener(e,(e=>{s(e.detail)}),!1)}},r=a=>{let{items:r,activeValue:l,onTitleClick:c}=a;const i={all:0,attending:0,not_attending:0,waiting_list:0};if("object"==typeof GatherPress)for(const[e,t]of Object.entries(GatherPress.attendees))i[e]=t.count;const[o,d]=(0,t.useState)(i);n({setAttendanceCount:d},GatherPress.post_id);const m=r.map(((t,a)=>{const n=t.value===l?"wp-block-gatherpress-attendance-list__current":"";return(0,e.createElement)(s,{key:a,item:t,count:o[t.value],additionalClasses:n,onTitleClick:c})}));return(0,e.createElement)("nav",{className:"wp-block-gatherpress-attendance-list__navigation"},m)},l=t=>{let{eventId:s,value:r,limit:l,attendees:c=[],avatarOnly:i=!1}=t;const[o,d]=(0,e.useState)(c);n({setAttendanceList:d},s);let m="";return"object"==typeof o&&void 0!==o[r]&&(c=[...o[r].attendees],l&&(c=c.splice(0,l)),m=c.map(((t,a)=>{const{profile:s,name:n,photo:r,role:l}=t;let{guests:c}=t;return c=c?" +"+c+" guest(s)":"",(0,e.createElement)("div",{key:a,className:"wp-block-gatherpress-attendance-list__item"},(0,e.createElement)("figure",{className:"wp-block-gatherpress-attendance-list__member-avatar"},(0,e.createElement)("a",{href:s},(0,e.createElement)("img",{alt:n,title:n,src:r}))),!1===i&&(0,e.createElement)("div",{className:"wp-block-gatherpress-attendance-list__member-info"},(0,e.createElement)("div",{className:"wp-block-gatherpress-attendance-list__member-name"},(0,e.createElement)("a",{href:s},n)),(0,e.createElement)("div",{className:"wp-block-gatherpress-attendance-list__member-role"},l),(0,e.createElement)("small",{className:"wp-block-gatherpress-attendance-list__guests"},c)))}))),(0,e.createElement)(e.Fragment,null,"attending"===r&&0===m.length&&!1===i&&(0,e.createElement)("div",{className:"wp-block-gatherpress-attendance-list__no-attendees"},"1"!==GatherPress.has_event_past?(0,a.__)("No one is attending this event yet.","gatherpress"):(0,a.__)("No one went to this event.","gatherpress")),m)},c=t=>{let{items:a,activeValue:s,limit:n=!1}=t;const r=a.map(((t,a)=>{const{value:r}=t,c=r===s?"active":"hidden",i=GatherPress.post_id,o=GatherPress.attendees;return(0,e.createElement)("div",{key:a,className:`wp-block-gatherpress-attendance-list__items wp-block-gatherpress-attendance-list__${c}`,id:`gp-attendance-${r}`,role:"tabpanel","aria-labelledby":`gp-attendance-${r}-tab`},(0,e.createElement)(l,{eventId:i,value:r,limit:n,attendees:o}))}));return(0,e.createElement)("div",{className:"wp-block-gatherpress-attendance-list__content"},r)},i=()=>{let t="attending";const s=[{title:"1"!==GatherPress.has_event_past?(0,a.__)("Attending","gatherpress"):(0,a.__)("Went","gatherpress"),value:"attending"},{title:"1"!==GatherPress.has_event_past?(0,a.__)("Waiting List","gatherpress"):(0,a.__)("Wait Listed","gatherpress"),value:"waiting_list"},{title:"1"!==GatherPress.has_event_past?(0,a.__)("Not Attending","gatherpress"):(0,a.__)("Didn't Go","gatherpress"),value:"not_attending"}];"object"==typeof GatherPress&&(t=void 0!==GatherPress.current_user.status&&"attend"!==GatherPress.current_user.status?GatherPress.current_user.status:t);const[l,i]=(0,e.useState)(t),[o,d]=(0,e.useState)(10);let m;return n({setAttendanceStatus:i},GatherPress.post_id),m=!1===o?(0,a.__)("See less","gatherpress"):(0,a.__)("See more","gatherpress"),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"wp-block-gatherpress-attendance-list__wrapper"},(0,e.createElement)(r,{items:s,activeValue:l,onTitleClick:(e,t)=>{e.preventDefault(),i(t)}}),(0,e.createElement)(c,{items:s,activeValue:l,limit:o})),(0,e.createElement)("div",{className:"has-text-align-right"},(0,e.createElement)("a",{href:"#",onClick:e=>(e=>{e.preventDefault(),d(!1===o&&10)})(e)},m)))};document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelectorAll('[data-gp_block_name="attendance-list"]');for(let a=0;a<t.length;a++)(0,e.render)((0,e.createElement)(i,null),t[a])}))})();