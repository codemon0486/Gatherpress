(()=>{"use strict";const e=window.wp.element,t=window.wp.i18n,a=t=>{let{item:a,additionalClasses:n,count:s,onTitleClick:l}=t;const{title:i,value:c}=a,r=0===s&&"attending"!==c?"hidden":"active";return(0,e.createElement)("div",{className:`gp-attendance-list__navigation-item gp-attendance-list__${r} ${n}`},(0,e.createElement)("a",{className:"gp-attendance-list__anchor","data-item":c,"data-toggle":"tab",href:"#",role:"tab","aria-controls":`#gp-attendance-${c}`,onClick:e=>l(e,c)},i),(0,e.createElement)("span",{className:"gp-attendance-list__count"},"(",s,")"))},n=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const[a,n]of Object.entries(e)){let e=a;t&&(e+=t),addEventListener(e,(e=>{n(e.detail)}),!1)}};function s(e){if("object"==typeof GatherPress)return e.split(".").reduce(((e,t)=>e&&e[t]),GatherPress)}window.wp.data;const l=t=>{let{items:l,activeValue:i,onTitleClick:c}=t;const r={all:0,attending:0,not_attending:0,waiting_list:0};for(const[e,t]of Object.entries(s("attendees")))r[e]=t.count;const[d,o]=(0,e.useState)(r);n({setAttendanceCount:o},s("post_id"));const m=l.map(((t,n)=>{const s=t.value===i?"gp-attendance-list__current":"";return(0,e.createElement)(a,{key:n,item:t,count:d[t.value],additionalClasses:s,onTitleClick:c})}));return(0,e.createElement)("nav",{className:"gp-attendance-list__navigation"},m)},i=a=>{let{eventId:l,value:i,limit:c,attendees:r=[],avatarOnly:d=!1}=a;const[o,m]=(0,e.useState)(r);n({setAttendanceList:m},l);let _="";return"object"==typeof o&&void 0!==o[i]&&(r=[...o[i].attendees],c&&(r=r.splice(0,c)),_=r.map(((t,a)=>{const{profile:n,name:s,photo:l,role:i}=t;let{guests:c}=t;return c=c?" +"+c+" guest(s)":"",(0,e.createElement)("div",{key:a,className:"gp-attendance-list__item"},(0,e.createElement)("figure",{className:"gp-attendance-list__member-avatar"},(0,e.createElement)("a",{href:n},(0,e.createElement)("img",{alt:s,title:s,src:l}))),!1===d&&(0,e.createElement)("div",{className:"gp-attendance-list__member-info"},(0,e.createElement)("div",{className:"gp-attendance-list__member-name"},(0,e.createElement)("a",{href:n},s)),(0,e.createElement)("div",{className:"gp-attendance-list__member-role"},i),(0,e.createElement)("small",{className:"gp-attendance-list__guests"},c)))}))),(0,e.createElement)(e.Fragment,null,"attending"===i&&0===_.length&&!1===d&&(0,e.createElement)("div",{className:"gp-attendance-list__no-attendees"},!1===s("has_event_past")?(0,t.__)("No one is attending this event yet.","gatherpress"):(0,t.__)("No one went to this event.","gatherpress")),_)},c=t=>{let{items:a,activeValue:n,limit:l=!1}=t;const c=s("post_id"),r=s("attendees"),d=a.map(((t,a)=>{const{value:s}=t,d=s===n?"active":"hidden";return(0,e.createElement)("div",{key:a,className:`gp-attendance-list__items gp-attendance-list__${d}`,id:`gp-attendance-${s}`,role:"tabpanel","aria-labelledby":`gp-attendance-${s}-tab`},(0,e.createElement)(i,{eventId:c,value:s,limit:l,attendees:r}))}));return(0,e.createElement)("div",{className:"gp-attendance-list__content"},d)},r=()=>{let a="attending";const i=s("has_event_past"),r=s("current_user.status"),d=[{title:!1===i?(0,t.__)("Attending","gatherpress"):(0,t.__)("Went","gatherpress"),value:"attending"},{title:!1===i?(0,t.__)("Waiting List","gatherpress"):(0,t.__)("Wait Listed","gatherpress"),value:"waiting_list"},{title:!1===i?(0,t.__)("Not Attending","gatherpress"):(0,t.__)("Didn't Go","gatherpress"),value:"not_attending"}];a=void 0!==r&&"attend"!==r?r:a;const[o,m]=(0,e.useState)(a),[_,g]=(0,e.useState)(10);let p;return n({setAttendanceStatus:m},s("post_id")),p=!1===_?(0,t.__)("See less","gatherpress"):(0,t.__)("See more","gatherpress"),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"gp-attendance-list"},(0,e.createElement)(l,{items:d,activeValue:o,onTitleClick:(e,t)=>{e.preventDefault(),m(t)}}),(0,e.createElement)(c,{items:d,activeValue:o,limit:_})),(0,e.createElement)("div",{className:"has-text-align-right"},(0,e.createElement)("a",{href:"#",onClick:e=>(e=>{e.preventDefault(),g(!1===_&&10)})(e)},p)))};document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelectorAll('[data-gp_block_name="attendance-list"]');for(let a=0;a<t.length;a++)(0,e.render)((0,e.createElement)(r,null),t[a])}))})();