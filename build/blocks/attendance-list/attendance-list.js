(()=>{"use strict";const e=window.wp.element,t=window.React,a=window.wp.i18n,n=t=>{let{item:a,additionalClasses:n,count:s,onTitleClick:l}=t;const{title:r,value:i}=a,c=0===s&&"attending"!==i?"hidden":"active";return(0,e.createElement)("div",{className:`gp-attendance-list__navigation--item gp-attendance-list__${c} ${n}`},(0,e.createElement)("a",{className:"gp-attendance-list__anchor","data-item":i,"data-toggle":"tab",href:"#",role:"tab","aria-controls":`#gp-attendance-${i}`,onClick:e=>l(e,i)},r),(0,e.createElement)("span",{className:"gp-attendance-list__count"},"(",s,")"))},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(const[a,n]of Object.entries(e)){let e=a;t&&(e+=t),addEventListener(e,(e=>{n(e.detail)}),!1)}},l=a=>{let{items:l,activeValue:r,onTitleClick:i}=a;const c={all:0,attending:0,not_attending:0,waiting_list:0};if("object"==typeof GatherPress)for(const[e,t]of Object.entries(GatherPress.attendees))c[e]=t.count;const[d,o]=(0,t.useState)(c);s({setAttendanceCount:o},GatherPress.post_id);const m=l.map(((t,a)=>{const s=t.value===r?"gp-attendance-list__navigation--current":"";return(0,e.createElement)(n,{key:a,item:t,count:d[t.value],additionalClasses:s,onTitleClick:i})}));return(0,e.createElement)("nav",{className:"gp-attendance-list__navigation"},m)},r=t=>{let{eventId:n,value:l,limit:r,attendees:i=[],avatarOnly:c=!1}=t;const[d,o]=(0,e.useState)(i);s({setAttendanceList:o},n);let m="";return"object"==typeof d&&void 0!==d[l]&&(i=[...d[l].attendees],r&&(i=i.splice(0,r)),m=i.map(((t,a)=>{const{profile:n,name:s,photo:l,role:r}=t;let{guests:i}=t;return i=i?" +"+i+" guest(s)":"",(0,e.createElement)("div",{key:a,className:"gp-attendance-list__items--item"},(0,e.createElement)("figure",{className:"gp-attendance-list__member-avatar"},(0,e.createElement)("a",{href:n},(0,e.createElement)("img",{alt:s,title:s,src:l}))),!1===c&&(0,e.createElement)("div",{className:"gp-attendance-list__member-info"},(0,e.createElement)("div",{className:"gp-attendance-list__member-name"},(0,e.createElement)("a",{href:n},s)),(0,e.createElement)("div",{className:"gp-attendance-list__member-role"},r),(0,e.createElement)("small",{className:"gp-attendance-list__guests"},i)))}))),(0,e.createElement)(e.Fragment,null,"attending"===l&&0===m.length&&!1===c&&(0,e.createElement)("div",{className:"gp-attendance-list__no-attendees"},"1"!==GatherPress.has_event_past?(0,a.__)("No one is attending this event yet.","gatherpress"):(0,a.__)("No one went to this event.","gatherpress")),m)},i=t=>{let{items:a,activeValue:n,limit:s=!1}=t;const l=a.map(((t,a)=>{const{value:l}=t,i=l===n?"active":"hidden",c=GatherPress.post_id,d=GatherPress.attendees;return(0,e.createElement)("div",{key:a,className:`gp-attendance-list__items gp-attendance-list__${i}`,id:`gp-attendance-${l}`,role:"tabpanel","aria-labelledby":`gp-attendance-${l}-tab`},(0,e.createElement)(r,{eventId:c,value:l,limit:s,attendees:d}))}));return(0,e.createElement)("div",{className:"gp-attendance-list__container"},l)},c=()=>{let t="attending";const n=[{title:"1"!==GatherPress.has_event_past?(0,a.__)("Attending","gatherpress"):(0,a.__)("Went","gatherpress"),value:"attending"},{title:"1"!==GatherPress.has_event_past?(0,a.__)("Waiting List","gatherpress"):(0,a.__)("Wait Listed","gatherpress"),value:"waiting_list"},{title:"1"!==GatherPress.has_event_past?(0,a.__)("Not Attending","gatherpress"):(0,a.__)("Didn't Go","gatherpress"),value:"not_attending"}];"object"==typeof GatherPress&&(t=void 0!==GatherPress.current_user.status&&"attend"!==GatherPress.current_user.status?GatherPress.current_user.status:t);const[r,c]=(0,e.useState)(t),[d,o]=(0,e.useState)(10);let m;return s({setAttendanceStatus:c},GatherPress.post_id),m=!1===d?(0,a.__)("See less","gatherpress"):(0,a.__)("See more","gatherpress"),(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{className:"gp-attendance-list"},(0,e.createElement)(l,{items:n,activeValue:r,onTitleClick:(e,t)=>{e.preventDefault(),c(t)}}),(0,e.createElement)(i,{items:n,activeValue:r,limit:d})),(0,e.createElement)("div",{className:"has-text-align-right"},(0,e.createElement)("a",{href:"#",onClick:e=>(e=>{e.preventDefault(),o(!1===d&&10)})(e)},m)))};document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelectorAll('[data-gp_block_name="attendance-list"]');for(let a=0;a<t.length;a++)(0,e.render)((0,e.createElement)(c,null),t[a])}))})();