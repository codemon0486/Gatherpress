(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var a in s)e.o(s,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:s[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,s=window.wp.domReady;var a=e.n(s);const n=window.wp.i18n,r=(e,t=!1)=>{for(const[s,a]of Object.entries(e)){let e=s;t&&(e+=t),addEventListener(e,(e=>{a(e.detail)}),!1)}};function i(e){if("object"==typeof GatherPress)return e.split(".").reduce(((e,t)=>e&&e[t]),GatherPress)}window.wp.data;const l=({item:e,activeItem:s=!1,count:a,onTitleClick:n,rsvpLimit:r})=>{const{title:l,value:p}=e,o=0===a&&"attending"!==p?"hidden":"active",c=s?"span":"a",m=i("post_id");return s&&((e,t=!1)=>{for(const[s,a]of Object.entries(e)){let e=s;t&&(e+=t);const n=new CustomEvent(e,{detail:a});dispatchEvent(n)}})({setRsvpSeeAllLink:a>r?"active":"hidden"},m),(0,t.createElement)("div",{className:`gp-rsvp-response__navigation-item gp-rsvp-response__${o}`},(0,t.createElement)(c,{className:"gp-rsvp-response__anchor","data-item":p,"data-toggle":"tab",href:"#",role:"tab","aria-controls":`#gp-rsvp-${p}`,onClick:e=>n(e,p)},l),(0,t.createElement)("span",{className:"gp-rsvp-response__count"},"(",a,")"))},p=({items:e,activeValue:s,onTitleClick:a,rsvpLimit:n})=>{const p={all:0,attending:0,not_attending:0,waiting_list:0};for(const[e,t]of Object.entries(i("responses")))p[e]=t.count;const[o,c]=(0,t.useState)(p);r({setRsvpCount:c},i("post_id"));let m=0;const v=e.map(((e,r)=>{const i=e.value===s;return i&&(m=r),(0,t.createElement)(l,{key:r,item:e,count:o[e.value],activeItem:i,onTitleClick:a,rsvpLimit:n})}));return(0,t.createElement)("div",{className:"gp-rsvp-response__navigation-wrapper"},(0,t.createElement)("div",{className:"gp-rsvp-response__navigation-active"},e[m].title," (",o[s],")"),(0,t.createElement)("nav",{className:"gp-rsvp-response__navigation"},v))},o=({items:e,activeValue:s,onTitleClick:a,rsvpLimit:l,setRsvpLimit:o,defaultLimit:c})=>{let m;m=!1===l?(0,n.__)("See fewer","gatherpress"):(0,n.__)("See all","gatherpress");const[v,_]=(0,t.useState)("hidden");return r({setRsvpSeeAllLink:_},i("post_id")),(0,t.createElement)("div",{className:"gp-rsvp-response__header"},(0,t.createElement)("div",{className:"dashicons dashicons-groups"}),(0,t.createElement)(p,{items:e,activeValue:s,onTitleClick:a,rsvpLimit:l}),(0,t.createElement)("div",{className:`gp-rsvp-response__see-all gp-rsvp-response__see-all--${v}`},(0,t.createElement)("a",{href:"#",onClick:e=>(e=>{e.preventDefault(),o(!1===l&&c)})(e)},m)))},c=({eventId:e,value:s,limit:a,responses:l=[],avatarOnly:p=!1})=>{const[o,c]=(0,t.useState)(l);r({setRsvpResponse:c},e);let m="";return"object"==typeof o&&void 0!==o[s]&&(l=[...o[s].responses],a&&(l=l.splice(0,a)),m=l.map(((e,s)=>{const{profile:a,name:n,photo:r,role:i}=e;let{guests:l}=e;return l=l?" +"+l+" guest(s)":"",(0,t.createElement)("div",{key:s,className:"gp-rsvp-response__item"},(0,t.createElement)("figure",{className:"gp-rsvp-response__member-avatar"},(0,t.createElement)("a",{href:a},(0,t.createElement)("img",{alt:n,title:n,src:r}))),!1===p&&(0,t.createElement)("div",{className:"gp-rsvp-response__member-info"},(0,t.createElement)("div",{className:"gp-rsvp-response__member-name"},(0,t.createElement)("a",{href:a},n)),(0,t.createElement)("div",{className:"gp-rsvp-response__member-role"},i),(0,t.createElement)("small",{className:"gp-rsvp-response__guests"},l)))}))),(0,t.createElement)(t.Fragment,null,"attending"===s&&0===m.length&&!1===p&&(0,t.createElement)("div",{className:"gp-rsvp-response__no-responses"},!1===i("has_event_past")?(0,n.__)("No one is attending this event yet.","gatherpress"):(0,n.__)("No one went to this event.","gatherpress")),m)},m=({items:e,activeValue:s,limit:a=!1})=>{const n=i("post_id"),r=i("responses"),l=e.map(((e,i)=>{const{value:l}=e,p=l===s?"active":"hidden";return(0,t.createElement)("div",{key:i,className:`gp-rsvp-response__items gp-rsvp-response__${p}`,id:`gp-rsvp-${l}`,role:"tabpanel","aria-labelledby":`gp-rsvp-${l}-tab`},(0,t.createElement)(c,{eventId:n,value:l,limit:a,responses:r}))}));return(0,t.createElement)("div",{className:"gp-rsvp-response__content"},l)},v=()=>{let e="attending";const s=i("has_event_past"),a=i("current_user.status"),l=[{title:!1===s?(0,n.__)("Attending","gatherpress"):(0,n.__)("Went","gatherpress"),value:"attending"},{title:!1===s?(0,n.__)("Waiting List","gatherpress"):(0,n.__)("Wait Listed","gatherpress"),value:"waiting_list"},{title:!1===s?(0,n.__)("Not Attending","gatherpress"):(0,n.__)("Didn't Go","gatherpress"),value:"not_attending"}];e=void 0!==a&&"attend"!==a&&""!==a?a:e;const[p,c]=(0,t.useState)(e),[v,_]=(0,t.useState)(8);return r({setRsvpStatus:c},i("post_id")),(0,t.createElement)("div",{className:"gp-rsvp-response"},(0,t.createElement)(o,{items:l,activeValue:p,onTitleClick:(e,t)=>{e.preventDefault(),c(t)},rsvpLimit:v,setRsvpLimit:_,defaultLimit:8}),(0,t.createElement)(m,{items:l,activeValue:p,limit:v}))};a()((()=>{const e=document.querySelectorAll('[data-gp_block_name="rsvp-response"]');for(let s=0;s<e.length;s++)(0,t.createRoot)(e[s]).render((0,t.createElement)(v,null))}))})();